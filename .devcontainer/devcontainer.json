{
    "name": "Dev Container: Python",
    "image": "mcr.microsoft.com/devcontainers/python:1-3.11-bullseye",
    "version": "1.0.0",
    "buildArgs": {
        "RUN_USER": "${remoteUser}"
    },
    "containerFeatures": [
        "ghcr.io/devcontainers/features/docker-outside-of-docker:1"
    ],
    "customizations": {
        "vscode": {
            "settings": {
                "files.autoSave": "onFocusChange",
                "editor.formatOnSave": true,
                "[python]": {
                    "editor.defaultFormatter": "ms-python.python",
                    "editor.formatOnSave": true
                },
                "editor.codeActionsOnSave": {
                    "source.organizeImports": true,
                    "source.fixAll": true,
                    "source.fixAll.sortImports": true
                },
                "python.defaultInterpreterPath": "/usr/local/bin/python",
                "python.pip.downloadCache": "${containerWorkspaceFolder}/.pip-cache",
                "black-formatter.args": [
                    "--line-length",
                    "88",
                    "--target-version",
                    "py311"
                ],
                "python.linting.enabled": true,
                "python.linting.pylintEnabled": true,
                "python.linting.pylintArgs": [
                    "--disable=C0111",
                    "--disable=C0103",
                    "--max-line-length=88",
                    "--good-names=i,j,k,ex,Run,_",
                    "--ignore-patterns=test_.*?py",
                    "--load-plugins=pylint.extensions.docparams"
                ],
                "isort.args": [
                    "--profile",
                    "black",
                    "--multi-line",
                    "3",
                    "--include-trailing-comma",
                    "--force-grid-wrap",
                    "0",
                    "--use-parentheses",
                    "--line-after-imports",
                    "--line-before-comment"
                ],
                "isort.check": true,
                "autoDocstring.docstringFormat": "google",
                "autoDocstring.startOnNewLine": true,
                "docformatter.args": [
                    "--in-place",
                    "--blank",
                    "--wrap-summaries",
                    "120",
                    "--wrap-descriptions",
                    "120"
                ],
                "python.analysis.diagnosticMode": "workspace",
                "python.analysis.importFormat": "relative",
                "python.linting.flake8Enabled": true,
                "python.linting.flake8Args": [
                    "--max-line-length=88",
                    "--ignore=E203,W503"
                ],
                "mypy.enabled": true,
                "mypy.runUsingActiveInterpreter": true,
                "mypy.args": [
                    "--strict"
                ],
                "python.testing.pytestEnabled": true,
                "python.testing.pytestArgs": [
                    "tests"
                ],
                "python.analysis.inlayHints.functionReturnTypes": true,
                "python.analysis.inlayHints.variableTypes": true,
                "git.enableSmartCommit": true,
                "git.confirmSync": false,
                "git.autofetch": true,
                "terminal.integrated.enablePersistentSessions": true,
                "terminal.integrated.scrollback": 5000,
                "debugging.autoExpandLazyVariables": true,
                "sonarlint.pathToNodeExecutable": "/usr/bin/node",
                "sonarlint.codeLens.enabled": true
            },
            "extensions": [
                "ms-python.python",
                "ms-python.vscode-pylance",
                "GitHub.copilot",
                "GitHub.copilot-chat",
                "ms-python.pylint",
                "ms-toolsai.jupyter",
                "mhutchie.git-graph",
                "eamodio.gitlens",
                "njpwerner.autodocstring",
                "ms-python.black-formatter",
                "ms-python.isort",
                "ms-python.flake8",
                "ms-python.mypy-type-checker",
                "Continue.continue",
                "ms-kubernetes-tools.vscode-kubernetes-tools",
                "GitHub.vscode-pull-request-github",
                "ms-azuretools.vscode-docker",
                "ms-mssql.mssql",
                "DavidAnson.vscode-markdownlint",
                "mtxr.sqltools",
                "donjayamanne.githistory",
                "batisteo.vscode-django",
                "VisualStudioExptTeam.vscodeintellicode",
                "VisualStudioExptTeam.intellicode-api-usage-examples",
                "donjayamanne.python-extension-pack",
                "ms-python.autopep8",
                "ms-mssql.data-workspace-vscode",
                "dbaeumer.vscode-eslint",
                "ms-toolsai.vscode-jupyter-cell-tags",
                "ms-toolsai.jupyter-renderers",
                "ms-toolsai.vscode-jupyter-slideshow",
                "ms-python.debugpy",
                "donjayamanne.python-environment-manager",
                "MS-CEINTL.vscode-language-pack-ru",
                "ms-mssql.sql-bindings-vscode",
                "ms-mssql.sql-database-projects-vscode",
                "redhat.vscode-yaml",
                "wholroyd.jinja",
                "cstrap.flask-snippets",
                "ms-toolsai.jupyter-keymap",
                "KevinRose.vsc-python-indent",
                "sonarsource.sonarlint-vscode",
                "streetsidesoftware.code-spell-checker",
                "yzhang.markdown-all-in-one"
            ]
        }
    },
    "remoteUser": "vscode",
    "updateRemoteUserUID": false,
    "skipNonBlocking": true,
    "mounts": [
        "source=/var/run/docker.sock,target=/var/run/docker.sock,type=bind"
    ],
    "forwardPorts": [
        11434,
        43619
    ],
    "containerEnv": {
        "SHELL": "/bin/bash",
        "DISPLAY": ":1",
        "XDG_RUNTIME_DIR": "/tmp/runtime-vscode",
        "PYTHONPATH": "${containerWorkspaceFolder}",
        "OLLAMA_HOST": "172.17.0.1",
        "OLLAMA_ORIGINS": "*",
        "OLLAMA_API_BASE_URL": "http://172.17.0.1:11434",
        "OLLAMA_API_PORT": "11434"
    },
    "runArgs": [
        "--add-host=host.docker.internal:host-gateway",
        "--init",
        "-e",
        "DISPLAY=:1",
        "-v",
        "/tmp/.X11-unix:/tmp/.X11-unix"
    ],
    "postCreateCommand": "if [ -d .devcontainer ] && [ -f .devcontainer/setup.sh ]; then chmod +x .devcontainer/setup.sh && .devcontainer/setup.sh; fi"
}